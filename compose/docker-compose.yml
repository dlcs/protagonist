version: '3'

services:
  orchestrator:
    build:
      context: ../
      dockerfile: Dockerfile.Orchestrator
    ports:
      - "5024:80"
      - "5034:443"
    env_file:
      - .env
    volumes:
      - $HOME\Docker\scratch:/nas
      - $HOME\.aws:/root/.aws:ro

  image-server:
    image: ghcr.io/dlcs/iipsrv-openjpeg:2.4.0
    ports:
      - "5025:8080"
    volumes:
      - $HOME\Docker\scratch:/nas
    entrypoint: /operations.sh

  thumbs:
    build:
      context: ../
      dockerfile: Dockerfile.Thumbs
    ports:
      - "5026:80"
    env_file:
      - .env
    volumes:
      - $HOME\.aws:/root/.aws
